{"ast":null,"code":"import config from 'config';\nimport React from 'react';\nimport { authHeader } from '../_helpers';\n\nclass userService extends React.Component() {\n  constructor(props) {\n    super(props);\n  }\n\n  login(username, password) {\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        username,\n        password\n      })\n    };\n    fetch(\"/users/authenticate\", requestOptions).then(this.handleResponse).then(user => {\n      // login successful if there's a user in the response\n      if (user) {\n        // store user details and basic auth credentials in local storage \n        // to keep user logged in between page refreshes\n        user.authdata = window.btoa(username + ':' + password);\n        localStorage.setItem('user', JSON.stringify(user));\n      }\n\n      return user;\n    });\n  }\n\n  logout() {\n    // remove user from local storage to log user out\n    localStorage.removeItem('user');\n  }\n\n  getAll() {\n    const requestOptions = {\n      method: 'GET',\n      headers: authHeader()\n    };\n    return fetch(\"\".concat(config.apiUrl, \"/users\"), requestOptions).then(this.handleResponse);\n  }\n\n  handleResponse(response) {\n    return response.text().then(text => {\n      const data = text && JSON.parse(text);\n\n      if (!response.ok) {\n        if (response.status === 401) {\n          // auto logout if 401 response returned from api\n          this.logout();\n          this.reload(true);\n        }\n\n        const error = data && data.message || response.statusText;\n        return Promise.reject(error);\n      }\n\n      return data;\n    });\n  }\n\n}\n\nexport default userService;","map":{"version":3,"sources":["C:\\BoxTracker\\boxtrackerwebbapp\\src\\userService.js"],"names":["config","React","authHeader","userService","Component","constructor","props","login","username","password","requestOptions","method","headers","body","JSON","stringify","fetch","then","handleResponse","user","authdata","window","btoa","localStorage","setItem","logout","removeItem","getAll","apiUrl","response","text","data","parse","ok","status","reload","error","message","statusText","Promise","reject"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,aAA3B;;AAEA,MAAMC,WAAN,SAA0BF,KAAK,CAACG,SAAN,EAA1B,CACA;AACIC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AACD;;AAEDC,EAAAA,KAAK,CAACC,QAAD,EAAWC,QAAX,EACL;AACE,UAAMC,cAAc,GAAG;AACnBC,MAAAA,MAAM,EAAE,MADW;AAEnBC,MAAAA,OAAO,EAAE;AAAE,wBAAgB;AAAlB,OAFU;AAGnBC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAEP,QAAAA,QAAF;AAAYC,QAAAA;AAAZ,OAAf;AAHa,KAAvB;AAMAO,IAAAA,KAAK,wBAAwBN,cAAxB,CAAL,CACCO,IADD,CACM,KAAKC,cADX,EAECD,IAFD,CAEME,IAAI,IAAI;AACV;AACA,UAAIA,IAAJ,EAAU;AACN;AACA;AACAA,QAAAA,IAAI,CAACC,QAAL,GAAgBC,MAAM,CAACC,IAAP,CAAYd,QAAQ,GAAG,GAAX,GAAiBC,QAA7B,CAAhB;AACAc,QAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6BV,IAAI,CAACC,SAAL,CAAeI,IAAf,CAA7B;AACH;;AAED,aAAOA,IAAP;AACC,KAZL;AAaC;;AAETM,EAAAA,MAAM,GAAG;AACL;AACAF,IAAAA,YAAY,CAACG,UAAb,CAAwB,MAAxB;AACH;;AAEDC,EAAAA,MAAM,GAAG;AACL,UAAMjB,cAAc,GAAG;AACnBC,MAAAA,MAAM,EAAE,KADW;AAEnBC,MAAAA,OAAO,EAAEV,UAAU;AAFA,KAAvB;AAKA,WAAOc,KAAK,WAAIhB,MAAM,CAAC4B,MAAX,aAA2BlB,cAA3B,CAAL,CAAgDO,IAAhD,CAAqD,KAAKC,cAA1D,CAAP;AACH;;AAEDA,EAAAA,cAAc,CAACW,QAAD,EAAW;AACrB,WAAOA,QAAQ,CAACC,IAAT,GAAgBb,IAAhB,CAAqBa,IAAI,IAAI;AAChC,YAAMC,IAAI,GAAGD,IAAI,IAAIhB,IAAI,CAACkB,KAAL,CAAWF,IAAX,CAArB;;AACA,UAAI,CAACD,QAAQ,CAACI,EAAd,EAAkB;AACd,YAAIJ,QAAQ,CAACK,MAAT,KAAoB,GAAxB,EAA6B;AACzB;AACA,eAAKT,MAAL;AACA,eAAKU,MAAL,CAAY,IAAZ;AACH;;AAED,cAAMC,KAAK,GAAIL,IAAI,IAAIA,IAAI,CAACM,OAAd,IAA0BR,QAAQ,CAACS,UAAjD;AACA,eAAOC,OAAO,CAACC,MAAR,CAAeJ,KAAf,CAAP;AACH;;AAED,aAAOL,IAAP;AACH,KAdM,CAAP;AAeH;;AA1DD;;AA4DA,eAAe5B,WAAf","sourcesContent":["import config from 'config';\r\nimport React from 'react';\r\nimport { authHeader } from '../_helpers';\r\n\r\nclass userService extends React.Component()\r\n{\r\n    constructor(props) {\r\n        super(props)\r\n      }\r\n\r\n      login(username, password)\r\n      {\r\n        const requestOptions = {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ username, password })\r\n        };\r\n\r\n        fetch(`/users/authenticate`, requestOptions)\r\n        .then(this.handleResponse)\r\n        .then(user => {\r\n            // login successful if there's a user in the response\r\n            if (user) {\r\n                // store user details and basic auth credentials in local storage \r\n                // to keep user logged in between page refreshes\r\n                user.authdata = window.btoa(username + ':' + password);\r\n                localStorage.setItem('user', JSON.stringify(user));\r\n            }\r\n\r\n            return user;\r\n            });\r\n        }\r\n\r\nlogout() {\r\n    // remove user from local storage to log user out\r\n    localStorage.removeItem('user');\r\n}\r\n\r\ngetAll() {\r\n    const requestOptions = {\r\n        method: 'GET',\r\n        headers: authHeader()\r\n    };\r\n\r\n    return fetch(`${config.apiUrl}/users`, requestOptions).then(this.handleResponse);\r\n}\r\n\r\nhandleResponse(response) {\r\n    return response.text().then(text => {\r\n        const data = text && JSON.parse(text);\r\n        if (!response.ok) {\r\n            if (response.status === 401) {\r\n                // auto logout if 401 response returned from api\r\n                this.logout();\r\n                this.reload(true);\r\n            }\r\n\r\n            const error = (data && data.message) || response.statusText;\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        return data;\r\n    });\r\n}\r\n}\r\nexport default userService;"]},"metadata":{},"sourceType":"module"}